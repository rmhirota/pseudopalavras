###APÊNDICE A

```{r idade}
participantes <- pseudopalavras::dados %>% 
  dplyr::distinct(informante, .keep_all = TRUE) 

participantes %>% 
  dplyr::mutate(idade_cat = dplyr::case_when(
    idade < 27 ~ "entre 18 e 26",
    idade < 35 ~ "entre 27 e 34",
    idade < 46 ~ "entre 35 e 45",
    TRUE ~ "entre 46 e 60"
  )) %>% 
  dplyr::count(genero, idade_cat) %>% 
  ggplot2::ggplot(ggplot2::aes(
    x = idade_cat, y = n, fill = genero, label = n
  )) +
  ggplot2::geom_col() +
  ggplot2::geom_text(position = ggplot2::position_stack(vjust = 0.5)) +
  ggplot2::scale_fill_grey() +
  ggplot2::theme_minimal() +
  ggplot2::labs(
    x = ggplot2::element_blank(),
    fill = "Gênero"
  )
```
__Figura A.1__ _Gráfico de barras empilhadas_ do Gênero distribuído por faixas etárias 
da variável Idade (anos).


```{r perfil-informantes }
library(magrittr)
pseudopalavras::dados %>% 
  dplyr::distinct(informante, .keep_all = TRUE) %>% 
  dplyr::mutate(naturalidade = dplyr::case_when(
    naturalidade == "São Paulo" ~ "São Paulo, SP",
    stringr::str_detect(naturalidade, "SP") ~ "Outros municípios de SP",
    TRUE ~ "Outras UF"
  )) %>% 
  dplyr::count(naturalidade, sort = TRUE) %>% 
  knitr::kable(
    caption = "",
    booktabs = TRUE,
    table.attr = "style='width:30%;'", 
    col.names = c("Naturalidade", "Total")
  )
```

__Tabela A.1__ Perfil dos participantes de acordo com a Naturalidade.


```{r area-formacao}
participantes %>% 
  dplyr::count(area_formacao, sort = TRUE) %>% 
  knitr::kable(col.names = c(
    "Área de formação", "Total"
  ))
```

__Tabela A.2__ Frequência da variável dicotômica Área de formação.


```{r musica}
participantes %>% 
  dplyr::count(musica, sort = TRUE) %>% 
  knitr::kable(col.names = c(
    "Conhecimento em música", "Total"
  ))
  
```

__Tabela A.3__ Frequência da variável dicotômica  Música.

```{r linguas}
participantes %>% 
  dplyr::count(linguas, sort = TRUE) %>% 
  knitr::kable(col.names = c(
    "Conhecimento em línguas", "Total" ))
  
```

__Tabela A.4__ Frequência da variável dicotômica Línguas.


```{r grupo-tonicidade-alvo}
pseudopalavras::dados %>% 
  dplyr::count(tonicidade_alvo, grupo) %>% 
  tidyr::pivot_wider(names_from = grupo, values_from = n) %>%
  setNames(c(
    "tonicidade_alvo", 
    "g1",
    "g2",
    "g3",
    "g4"
  )) %>% 
  dplyr::mutate(total = g1 + g2 + g3 + g4) %>% 
  dplyr::transmute(
    tonicidade_alvo,
    g1 = glue::glue("{g1} ({scales::percent(g1/total)})"),
    g2 = glue::glue("{g2} ({scales::percent(g2/total)})"),
    g3 = glue::glue("{g3} ({scales::percent(g3/total)})"),
    g4 = glue::glue("{g4} ({scales::percent(g4/total)})"),
    total
  ) %>% 
  knitr::kable(col.names = c(
    "Tonicidade palavra-alvo", 
    "1 (Similar de alta freq.)",
    "2 (Dissimilar de alta freq.)",
    "3 (Similar de baixa freq.)",
    "4 (Dissimilar de baixa freq.)",
    "Total"
  )) %>% 
  
  kableExtra::add_header_above(
    c(" " = 1, "Grupo" = 4, " " = 1)
  )
```

__Tabela A.5__ Frequência do Grupo experimental por Tonicidade da palavra-alvo.


```{r grupo-tonicidade-producao}
pseudopalavras::dados %>% 
  dplyr::count(tonicidade_producao, grupo) %>% 
  tidyr::pivot_wider(names_from = grupo, values_from = n) %>%
  setNames(c(
    "tonicidade_producao", 
    "g1",
    "g2",
    "g3",
    "g4"
  )) %>% 
  dplyr::mutate(total = g1 + g2 + g3 + g4) %>% 
  dplyr::transmute(
    tonicidade_producao,
    g1 = glue::glue("{g1} ({scales::percent(g1/total)})"),
    g2 = glue::glue("{g2} ({scales::percent(g2/total)})"),
    g3 = glue::glue("{g3} ({scales::percent(g3/total)})"),
    g4 = glue::glue("{g4} ({scales::percent(g4/total)})"),
    total
  ) %>% 
  knitr::kable(col.names = c(
    "Tonicidade produção", 
    "1 (Similar de alta freq.)",
    "2 (Dissimilar de alta freq.)",
    "3 (Similar de baixa freq.)",
    "4 (Dissimilar de baixa freq.)",
    "Total"
  )) %>% 
  kableExtra::add_header_above(
    c(" " = 1, "Grupo" = 4, " " = 1)
  )
```

__Tabela A.6__ Frequência do Grupo experimental por Tonicidade da pseudopalavra.


```{r tonicidade-pseudoxalvo2}
pseudopalavras::dados %>%
  dplyr::count(tonicidade_producao, tonicidade_alvo) %>% 
  dplyr::mutate(
    tonicidade_producao = abjutils::rm_accent(tonicidade_producao)
  ) %>% 
  tidyr::pivot_wider(names_from = tonicidade_producao, values_from = n) %>% 
  dplyr::mutate(total = oxitona + paroxitona + proparoxitona) %>% 
  dplyr::transmute(
    tonicidade_alvo,
    oxitona = glue::glue("{oxitona} ({scales::percent(oxitona/total)})"),
    paroxitona = glue::glue(
      "{paroxitona} ({scales::percent(paroxitona/total)})"
    ),
    proparoxitona = glue::glue(
      "{proparoxitona} ({scales::percent(proparoxitona/total)})"
    ),
    total = glue::glue("{total} ({scales::percent(total/total)})")
  ) %>% 
  knitr::kable() %>% 
  kableExtra::add_header_above(
    c(" " = 1, "Tonicidade da pseudopalavra" = 3, " " = 1)
  )
```

__Tabela A.7__ Frequência da tonicidade das palavras-alvo por nível de tonicidade 
das pseudopalavras.

```{r validacao-grupo}
pseudopalavras::dados %>% 
  dplyr::count(grupo, validacao) %>% 
  tidyr::pivot_wider(names_from = validacao, values_from = n) %>%
  setNames(c(
    "tonicidade_producao", 
    "g1",
    "g2",
    "g3"
  )) %>% 
  dplyr::mutate(total = g1 + g2 + g3) %>% 
  dplyr::transmute(
    tonicidade_producao,
    g1 = glue::glue("{g1} ({scales::percent(g1/total)})"),
    g2 = glue::glue("{g2} ({scales::percent(g2/total)})"),
    g3 = glue::glue("{g3} ({scales::percent(g3/total)})"),
    total = glue::glue("{total} ({scales::percent(total/total)})")
  ) %>% 
  knitr::kable(col.names = c(
    "Grupo", 
    "Não Validada",
    "Quase Validada",
    "Validada",
    "Total"
  )
  #, row.names = c(
   # "1 (Similar de alta freq.)",
    #"2 (Dissimilar de alta freq.)",
    #"3 (Similar de baixa freq.)",
    #"4 (Dissimilar de baixa freq.)")
  ) %>% 
  kableExtra::add_header_above(
    c(" " = 1, "Status Validação" = 3, " " = 1)
  )
```

__Tabela A.8__ Frequência das pseudopalavras nos Grupos, por status de Validação.


```{r estrut-tonicidade-pseudo}
pseudopalavras::dados %>% 
  dplyr::count(estrutura_palavra, tonicidade_producao) %>% 
  tidyr::pivot_wider(names_from = estrutura_palavra, values_from = n) %>% 
  setNames(c("tonicidade", "e1", "e2")) %>% 
  dplyr::mutate(
    total = e1 + e2,
    e1 = glue::glue("{e1} ({scales::percent(e1/total)})"),
    e2 = glue::glue("{e2} ({scales::percent(e2/total)})")
  ) %>% 
  dplyr::relocate(tonicidade, e1, e2, total) %>% 
  knitr::kable(col.names = c(
    "Tonicidade palavra produção", "CV-CV-CV", "CV-CV-CVC", "Total"
  )) %>% 
  kableExtra::add_header_above(
    c(" " = 1, "Estrutura da palavra" = 2, " " = 1)
  )
```
#colocar total embaixo
__Tabela A.9__ Atribuições acentuais por Estrutura das palavras.







